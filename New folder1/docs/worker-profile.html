<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classic Work Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* Background inspired by JobBox image: subtle gradient or solid light blue-grey */
            background: linear-gradient(135deg, #f0f2f5 0%, #e6e9ed 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        /* Styling for the main content cards (dashboard) */
        .main-card {
            background-color: #ffffff; /* Solid white background for cards */
            border: 1px solid #e0e6ed; /* Softer border color */
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08); /* Lighter, more diffused shadow */
            border-radius: 1.25rem; /* Slightly less rounded than before, matching JobBox cards */
            padding: 2.5rem;
            width: 100%;
            max-width: 1000px;
            transition: grid-template-columns 0.3s ease-in-out;
        }
        /* Input field styling */
        .input-field {
            background-color: #f8f9fb; /* Very light grey, almost white */
            border: 1px solid #dbe2ea; /* Soft grey border */
            color: #374151;
            padding: 0.85rem 1.25rem;
            border-radius: 0.625rem; /* Matches JobBox input fields */
            width: 100%;
            box-sizing: border-box;
        }
        .input-field:focus {
            outline: none;
            border-color: #4a90e2; /* A shade of blue from JobBox */
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.25);
        }
        /* Button styling */
        .action-button {
            background: linear-gradient(45deg, #4a90e2 0%, #357ABD 100%); /* Blue gradient inspired by JobBox buttons */
            color: white;
            font-weight: 600;
            padding: 0.85rem 1.75rem;
            border-radius: 0.625rem; /* Matches JobBox buttons */
            box-shadow: 0 4px 10px rgba(74, 144, 226, 0.25); /* Softer blue shadow */
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(74, 144, 226, 0.35);
        }
        /* Dashboard grid layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2.5rem;
            text-align: left;
            transition: grid-template-columns 0.3s ease-in-out;
        }
        .main-card.menu-open .dashboard-grid {
            grid-template-columns: 1.2fr 3fr;
        }

        /* Menu item styling */
        .menu-section {
            background-color: #ffffff; /* White background for menu section */
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05); /* Lighter shadow for menu card */
            display: none;
            transition: all 0.3s ease-in-out;
        }
        .main-card.menu-open .menu-section {
            display: block;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 0.85rem 1.25rem;
            border-radius: 0.625rem; /* Matching JobBox style */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out, transform 0.1s ease-in-out;
            cursor: pointer;
            color: #5a677a; /* Darker grey for menu items */
            font-weight: 500;
        }
        .menu-item:hover {
            background-color: #e6f0fa; /* Lighter blue hover */
            color: #4a90e2; /* Blue text for hover */
            transform: translateX(3px); /* Subtle slide effect */
        }
        .menu-item.active {
            background-color: #d9e8f7; /* Light blue active */
            color: #4a90e2; /* Blue text for active */
            font-weight: 600;
            box-shadow: 0 1px 4px rgba(74, 144, 226, 0.1);
        }
        .menu-item svg {
            margin-right: 0.85rem;
            color: #4a90e2; /* Blue icons for menu */
        }
        /* Content sections within the dashboard */
        .content-section > div {
            display: none;
        }
        .content-section > div.active {
            display: block;
        }
        #mainContentArea {
            padding-left: 5rem;
            padding-top: 2.5rem;
        }
        .main-card.menu-open #mainContentArea {
            padding-left: 0;
        }

        /* Recent work item styling */
        .recent-work-item {
            background-color: #ffffff;
            border: 1px solid #e0e6ed;
            padding: 1.2rem;
            border-radius: 0.625rem;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease-in-out;
        }
        .recent-work-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .recent-work-item svg {
            color: #4a90e2; /* Blue icons for recent work */
        }
        /* Profile detail items */
        .profile-detail-item {
            background-color: #ffffff;
            border: 1px solid #e0e6ed;
            padding: 1.2rem;
            border-radius: 0.625rem;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
        }
        .profile-detail-item .label {
            font-weight: 500;
            color: #5a677a;
        }
        .profile-detail-item .value {
            color: #1f2937;
        }
        /* Specific colors for icons/text to add variety */
        .text-blue-main { color: #4a90e2; } /* Main blue from JobBox */
        .text-green-main { color: #5cb85c; } /* Green from JobBox for 'Add Work' */
        .text-red-main { color: #d9534f; } /* Red from JobBox for 'Logout' */

        /* Profile Photo Styling */
        .profile-photo {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #4a90e2; /* Blue border */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s ease-in-out;
        }
        .profile-photo:hover {
            transform: scale(1.05);
        }

        /* Vibrant Welcome Text */
        .welcome-text-container {
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: -0.025em;
        }
        .welcome-text-container .welcome-line {
            background: linear-gradient(45deg, #4a90e2, #357ABD); /* Blue gradient */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
            display: block;
        }

        /* Quick Add Work Section Styling */
        .quick-add-work-section {
            background-color: #e6f0fa; /* Lighter blue background */
            border: 1px solid #d9e8f7;
            padding: 1.5rem;
            border-radius: 1rem;
            margin-top: 1.5rem;
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .quick-add-work-section .text-content {
            flex-grow: 1;
        }
        .quick-add-work-section .action-button {
            margin-left: 1.5rem;
            flex-shrink: 0;
        }

        /* Menu Toggle Button Styling */
        .menu-toggle-button {
            background-color: #4a90e2; /* Blue toggle button */
            color: white;
            padding: 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            z-index: 10;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
        }
        .menu-toggle-button:hover {
            background-color: #357ABD;
            transform: scale(1.05);
        }
        .menu-toggle-button svg {
            width: 24px;
            height: 24px;
        }

        /* Word count indicator styling */
        .word-count-info {
            font-size: 0.875rem; /* text-sm */
            color: #6b7280; /* text-gray-500 */
            margin-top: 0.25rem;
            text-align: right;
        }
        .word-count-error {
            color: #ef4444; /* text-red-500 */
            font-weight: 500;
        }

        /* Profile picture edit specific styles */
        .profile-picture-edit-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .profile-picture-preview {
            width: 120px; /* Larger preview */
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #4a90e2;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        .change-photo-button {
            background-color: #6c757d; /* Grey button for secondary action */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .change-photo-button:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>
    <!-- Dashboard Content (visible by default) -->
    <div id="dashboardContent" class="main-card relative">
        <!-- Menu Toggle Button -->
        <button id="menuToggleButton" class="menu-toggle-button">
            <!-- Hamburger Icon -->
            <svg id="hamburgerIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
            <!-- Close Icon (hidden by default) -->
            <svg id="closeIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>

        <div class="dashboard-grid">
            <!-- Left Menu -->
            <div id="menuSection" class="menu-section">
                <h3 class="text-lg font-semibold text-gray-700 mb-6 flex items-center">
                    <svg class="w-6 h-6 mr-2 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                    MENU
                </h3>
                <ul class="space-y-3 text-gray-700">
                    <li>
                        <a href="#" class="menu-item active" data-content="dashboard-home">
                            <svg class="w-5 h-5 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                            Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="#" class="menu-item" data-content="profile">
                            <svg class="w-5 h-5 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            My Profile
                        </a>
                    </li>
                    <li>
                        <a href="#" class="menu-item" data-content="add-work">
                            <svg class="w-5 h-5 text-green-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            Add Work Today
                        </a>
                    </li>
                    <li>
                        <a href="#" class="menu-item" data-content="work-history">
                            <svg class="w-5 h-5 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            My Work History
                        </a>
                    </li>
                    <li>
                        <a href="#" class="menu-item" data-content="logout">
                            <svg class="w-5 h-5 text-red-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                            Logout
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Right Content Sections -->
            <div id="mainContentArea" class="content-section">
                <!-- Dashboard Home Content (initially active) -->
                <div id="dashboard-home-section" class="active">
                    <div class="flex justify-between items-start mb-4">
                        <h2 class="font-bold text-gray-800">
                            <span class="welcome-text-container">
                                <span class="welcome-line">Welcome,</span>
                                <span class="welcome-line">Suresh Kumar!</span>
                            </span>
                        </h2>
                        <!-- Profile Photo in Header -->
                        <img id="headerProfilePhoto" src="https://placehold.co/90x90/4a90e2/FFFFFF?text=SK" alt="Profile Photo" class="profile-photo">
                    </div>

                    <!-- Quick Add Work Section (moved here) -->
                    <div class="quick-add-work-section mt-6 mb-8">
                        <div class="text-content">
                            <p class="text-blue-700 text-sm">Quickly add your daily tasks here.</p>
                        </div>
                        <button class="action-button" data-content="add-work">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                            Add New Work
                        </button>
                    </div>

                    <div class="recent-work-section bg-white p-6 rounded-xl shadow-sm">
                        <h3 class="text-lg font-semibold text-gray-700 mb-4">Recent Work</h3>
                        <ul id="recentWorkList" class="space-y-3 text-gray-700">
                            <li class="flex items-center p-3 recent-work-item rounded-lg">
                                <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                <span class="font-medium">19/07/2025</span> &mdash; Cleaned staircases,lift,and parking area.
                            </li>
                            <li class="flex items-center p-3 recent-work-item rounded-lg">
                                <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                <span class="font-medium">18/07/2025</span> &mdash; Sat with patients and comforted them.
                            </li>
                            <li class="flex items-center p-3 recent-work-item rounded-lg">
                                <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                <span class="font-medium">13/07/2025</span> &mdash; Helped with garbage collection and disposal.
                            </li>
                            <li class="flex items-center p-3 recent-work-item rounded-lg">
                                <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                <span class="font-medium">12/07/2025</span> &mdash; Helped the patient move around.
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- My Profile Section (hidden by default) -->
                <div id="profile-section">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        My Profile
                    </h2>
                    <div id="profileDetails" class="space-y-4 text-gray-700">
                        <div class="profile-detail-item">
                            <p class="label">Name: <span class="value" id="profileName">Suresh Kumar</span></p>
                        </div>
                        <div class="profile-detail-item">
                            <p class="label">Email: <span class="value" id="profileEmail">suresh.kumar@example.com</span></p>
                        </div>
                        <div class="profile-detail-item">
                            <p class="label">Contact: <span class="value" id="profileContact">+91 98765 43210</span></p>
                        </div>
                        <div class="profile-detail-item">
                            <p class="label">Address: <span class="value" id="profileAddress">123, Work Lane, Productivity City, 500001</span></p>
                        </div>
                        <div class="profile-detail-item">
                            <p class="label">Total Work Entries: <span class="value" id="profileTotalWork">45</span></p>
                        </div>
                        <div class="profile-detail-item">
                            <p class="label">Last Active: <span class="value" id="profileLastActive">19 July 2025</span></p>
                        </div>
                    </div>

                    <div id="profileEditForm" class="space-y-4 text-gray-700 hidden">
                        <div class="profile-picture-edit-container">
                            <img id="profilePicturePreview" src="https://placehold.co/120x120/4a90e2/FFFFFF?text=SK" alt="Profile Preview" class="profile-picture-preview">
                            <input type="file" id="profilePictureInput" accept="image/*" class="hidden">
                            <button type="button" id="changePhotoButton" class="change-photo-button">Change Photo</button>
                        </div>
                        <div>
                            <label for="editName" class="block text-gray-700 text-sm font-medium mb-1">Name</label>
                            <input type="text" id="editName" class="input-field" value="Suresh Kumar">
                        </div>
                        <div>
                            <label for="editEmail" class="block text-gray-700 text-sm font-medium mb-1">Email</label>
                            <input type="email" id="editEmail" class="input-field" value="suresh.kumar@example.com">
                        </div>
                        <div>
                            <label for="editContact" class="block text-gray-700 text-sm font-medium mb-1">Contact</label>
                            <input type="text" id="editContact" class="input-field" value="+91 98765 43210">
                        </div>
                        <div>
                            <label for="editAddress" class="block text-gray-700 text-sm font-medium mb-1">Address</label>
                            <textarea id="editAddress" rows="2" class="input-field">123, Work Lane, Productivity City, 500001</textarea>
                        </div>
                        <!-- These fields might not be editable in a real scenario but included for demonstration -->
                        <div>
                            <label for="editTotalWork" class="block text-gray-700 text-sm font-medium mb-1">Total Work Entries</label>
                            <input type="text" id="editTotalWork" class="input-field" value="45" disabled>
                        </div>
                        <div>
                            <label for="editLastActive" class="block text-gray-700 text-sm font-medium mb-1">Last Active</label>
                            <input type="text" id="editLastActive" class="input-field" value="19 July 2025" disabled>
                        </div>
                    </div>

                    <button id="toggleEditProfile" class="action-button mt-6">
                        Edit Profile
                    </button>
                </div>

                <!-- Add Work Today Section (hidden by default) -->
                <div id="add-work-section">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-green-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        Add Work Today
                    </h2>
                    <form id="addWorkForm" class="space-y-4">
                        <div>
                            <label for="work-date" class="block text-gray-700 text-sm font-medium mb-1">Date</label>
                            <input type="date" id="work-date" class="input-field" value="2025-07-19">
                        </div>
                        <div>
                            <label for="work-description" class="block text-gray-700 text-sm font-medium mb-1">Description</label>
                            <textarea id="work-description" rows="4" class="input-field" placeholder="Enter details of work done..." maxlength="400" required></textarea>
                            <div class="word-count-info">
                                <span id="wordCount">0</span>/<span id="wordLimit">60</span> words
                                <span id="wordLimitWarning" class="word-count-error hidden"> (Too many words!)</span>
                            </div>
                        </div>
                        <button type="submit" class="action-button" id="submitWorkButton">
                            Submit Work
                        </button>
                    </form>
                </div>

                <!-- My Work History Section (hidden by default) -->
                <div id="work-history-section">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        My Work History
                    </h2>
                    <ul id="workHistoryList" class="space-y-3 text-gray-700">
                        <!-- Existing entries -->
                        <li class="flex items-center p-3 bg-white rounded-lg shadow-sm">
                            <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            <span class="font-medium">19/07/2025</span> &mdash; Cleaned staircases,lift,and parking area.
                        </li>
                        <li class="flex items-center p-3 bg-white rounded-lg shadow-sm">
                            <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            <span class="font-medium">18/07/2025</span> &mdash; Sat with patients and comforted them.
                        </li>
                        <li class="flex items-center p-3 bg-white rounded-lg shadow-sm">
                            <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            <span class="font-medium">13/07/2025</span> &mdash; Helped with garbage collection and disposal.
                        </li>
                        <li class="flex items-center p-3 bg-white rounded-lg shadow-sm">
                            <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            <span class="font-medium">12/07/2025</span> &mdash; Helped the patient move around.
                        </li>
                    </ul>
                </div>

                <!-- Logout Section (simple message) -->
                <div id="logout-section">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <svg class="w-6 h-6 mr-2 text-red-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                        Logout
                    </h2>
                    <p class="text-gray-700 text-lg">You have been logged out. To log in again, simply refresh the page.</p>
                    <button class="action-button mt-6" onclick="window.location.reload();">
                        Refresh Page
                    </button>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Worker data storage
        let workerData = null;

        // Function to get URL parameters
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            const value = urlParams.get(name);
            console.log(`Getting URL parameter '${name}': ${value}`);
            return value;
        }

        // Function to fetch worker data from backend
        async function fetchWorkerData(phone) {
            console.log('Fetching worker data for phone:', phone);
            
            // For testing purposes, use mock data instead of API call
            // This will help us verify the dynamic functionality works
            const mockData = {
                name: 'John Doe',
                phone: phone,
                location: 'Mumbai, Maharashtra',
                email: 'john.doe@example.com',
                total_work_entries: '25',
                last_active: new Date().toLocaleDateString('en-GB'),
                work_history: [
                    {
                        date: '19/07/2025',
                        description: 'Cleaned staircases, lift, and parking area.'
                    },
                    {
                        date: '18/07/2025',
                        description: 'Sat with patients and comforted them.'
                    },
                    {
                        date: '13/07/2025',
                        description: 'Helped with garbage collection and disposal.'
                    },
                    {
                        date: '12/07/2025',
                        description: 'Helped the patient move around.'
                    }
                ]
            };
            
            console.log('Using mock data:', mockData);
            return mockData;
            
            // Uncomment this when backend is ready
            /*
            try {
                const response = await fetch(`http://127.0.0.1:8000/api/worker/profile?phone=${phone}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    console.log('API response:', data);
                    return data;
                } else {
                    console.error('Failed to fetch worker data');
                    return null;
                }
            } catch (error) {
                console.error('Error fetching worker data:', error);
                return null;
            }
            */
        }

        // Function to update UI with worker data
        function updateWorkerProfile(data) {
            console.log('updateWorkerProfile called with data:', data);
            if (!data) {
                console.log('No data provided, returning early');
                return;
            }

            // Update welcome message
            const welcomeLines = document.querySelectorAll('.welcome-line');
            console.log('Found welcome lines:', welcomeLines.length);
            if (welcomeLines.length >= 2) {
                welcomeLines[1].textContent = data.name + '!';
                console.log('Updated welcome message to:', data.name + '!');
            }

            // Update profile photo (generate initials)
            const initials = data.name.split(' ').map(n => n[0]).join('').toUpperCase();
            const profilePhotoUrl = `https://placehold.co/90x90/4a90e2/FFFFFF?text=${initials}`;
            console.log('Generated profile photo URL:', profilePhotoUrl);
            
            const headerProfilePhoto = document.getElementById('headerProfilePhoto');
            const profilePicturePreview = document.getElementById('profilePicturePreview');
            
            if (headerProfilePhoto) {
                headerProfilePhoto.src = profilePhotoUrl;
                console.log('Updated header profile photo');
            }
            if (profilePicturePreview) {
                profilePicturePreview.src = profilePhotoUrl;
                console.log('Updated profile picture preview');
            }

            // Update profile details
            const profileName = document.getElementById('profileName');
            const profileContact = document.getElementById('profileContact');
            const profileAddress = document.getElementById('profileAddress');
            const profileEmail = document.getElementById('profileEmail');
            const profileTotalWork = document.getElementById('profileTotalWork');
            const profileLastActive = document.getElementById('profileLastActive');

            if (profileName) {
                profileName.textContent = data.name;
                console.log('Updated profile name to:', data.name);
            }
            if (profileContact) {
                profileContact.textContent = data.phone;
                console.log('Updated profile contact to:', data.phone);
            }
            if (profileAddress) {
                profileAddress.textContent = data.location;
                console.log('Updated profile address to:', data.location);
            }
            if (profileEmail) {
                profileEmail.textContent = data.email || 'Not provided';
                console.log('Updated profile email to:', data.email || 'Not provided');
            }
            if (profileTotalWork) {
                profileTotalWork.textContent = data.total_work_entries || '0';
                console.log('Updated profile total work to:', data.total_work_entries || '0');
            }
            if (profileLastActive) {
                profileLastActive.textContent = data.last_active || new Date().toLocaleDateString('en-GB');
                console.log('Updated profile last active to:', data.last_active || new Date().toLocaleDateString('en-GB'));
            }

            // Update edit form fields
            const editName = document.getElementById('editName');
            const editContact = document.getElementById('editContact');
            const editAddress = document.getElementById('editAddress');
            const editEmail = document.getElementById('editEmail');
            const editTotalWork = document.getElementById('editTotalWork');
            const editLastActive = document.getElementById('editLastActive');

            if (editName) editName.value = data.name;
            if (editContact) editContact.value = data.phone;
            if (editAddress) editAddress.value = data.location;
            if (editEmail) editEmail.value = data.email || '';
            if (editTotalWork) editTotalWork.value = data.total_work_entries || '0';
            if (editLastActive) editLastActive.value = data.last_active || new Date().toLocaleDateString('en-GB');

            console.log('Updated all edit form fields');

            // Update work history if available
            if (data.work_history && data.work_history.length > 0) {
                console.log('Updating work history with:', data.work_history.length, 'entries');
                updateWorkHistory(data.work_history);
            } else {
                console.log('No work history data available');
            }
        }

        // Function to update work history
        function updateWorkHistory(workHistory) {
            const workHistoryList = document.getElementById('workHistoryList');
            const recentWorkList = document.getElementById('recentWorkList');
            
            // Clear existing entries
            workHistoryList.innerHTML = '';
            recentWorkList.innerHTML = '';

            workHistory.forEach(work => {
                const workItem = document.createElement('li');
                workItem.className = 'flex items-center p-3 bg-white rounded-lg shadow-sm';
                workItem.innerHTML = `
                    <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    <span class="font-medium">${work.date}</span> &mdash; ${work.description}
                `;

                workHistoryList.appendChild(workItem);
                
                // Add to recent work list (show only first 4 entries)
                if (recentWorkList.children.length < 4) {
                    const recentWorkItem = workItem.cloneNode(true);
                    recentWorkItem.classList.remove('bg-white', 'shadow-sm');
                    recentWorkItem.classList.add('recent-work-item', 'rounded-lg');
                    recentWorkList.appendChild(recentWorkItem);
                }
            });
        }

        // Function to submit work to backend
        async function submitWorkToBackend(workData) {
            try {
                const response = await fetch('http://127.0.0.1:8000/api/worker/add-work', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(workData)
                });

                if (response.ok) {
                    const result = await response.json();
                    return { success: true, data: result };
                } else {
                    const error = await response.json();
                    return { success: false, message: error.message };
                }
            } catch (error) {
                console.error('Error submitting work:', error);
                return { success: false, message: 'Failed to connect to server' };
            }
        }

        // Function to update profile in backend
        async function updateProfileInBackend(profileData) {
            try {
                const response = await fetch('http://127.0.0.1:8000/api/worker/update-profile', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(profileData)
                });

                if (response.ok) {
                    const result = await response.json();
                    return { success: true, data: result };
                } else {
                    const error = await response.json();
                    return { success: false, message: error.message };
                }
            } catch (error) {
                console.error('Error updating profile:', error);
                return { success: false, message: 'Failed to connect to server' };
            }
        }

        // Initialize worker profile on page load
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('Page loaded, initializing worker profile...');
            
            const phone = getUrlParameter('phone');
            console.log('Phone from URL:', phone);
            
            if (phone) {
                // Fetch worker data
                workerData = await fetchWorkerData(phone);
                console.log('Worker data received:', workerData);
                
                if (workerData) {
                    console.log('Updating UI with worker data...');
                    updateWorkerProfile(workerData);
                    console.log('UI updated successfully!');
                } else {
                    // Fallback to default data if API fails
                    console.warn('Using fallback data');
                    const fallbackData = {
                        name: 'Suresh Kumar',
                        phone: phone,
                        location: '123, Work Lane, Productivity City, 500001',
                        email: 'suresh.kumar@example.com',
                        total_work_entries: '45',
                        last_active: '19 July 2025'
                    };
                    updateWorkerProfile(fallbackData);
                }
            } else {
                console.error('No phone number provided in URL');
                // Redirect to login page or show error
                alert('Invalid access. Please login again.');
                window.location.href = 'final1.html';
            }

            // Set initial active section and menu item
            document.getElementById('dashboard-home-section').classList.add('active');
            document.querySelector('.menu-item[data-content="dashboard-home"]').classList.add('active');
            wordLimitSpan.textContent = MAX_WORDS; // Set the word limit display
            updateWordCount(); // Initial word count update
        });

        // Get all menu items and content sections
        const menuItems = document.querySelectorAll('.menu-item');
        const contentSections = document.querySelectorAll('.content-section > div');
        const quickAddWorkButton = document.querySelector('.action-button[data-content="add-work"]');

        // Menu toggle elements
        const dashboardContent = document.getElementById('dashboardContent');
        const menuSection = document.getElementById('menuSection');
        const menuToggleButton = document.getElementById('menuToggleButton');
        const hamburgerIcon = document.getElementById('hamburgerIcon');
        const closeIcon = document.getElementById('closeIcon');

        // Profile edit elements
        const profileDetails = document.getElementById('profileDetails');
        const profileEditForm = document.getElementById('profileEditForm');
        const toggleEditProfileButton = document.getElementById('toggleEditProfile');

        // Input fields for profile editing
        const editName = document.getElementById('editName');
        const editEmail = document.getElementById('editEmail');
        const editContact = document.getElementById('editContact');
        const editAddress = document.getElementById('editAddress');

        // Display elements for profile details
        const profileName = document.getElementById('profileName');
        const profileEmail = document.getElementById('profileEmail');
        const profileContact = document.getElementById('profileContact');
        const profileAddress = document.getElementById('profileAddress');

        // Profile picture elements
        const headerProfilePhoto = document.getElementById('headerProfilePhoto');
        const profilePicturePreview = document.getElementById('profilePicturePreview');
        const profilePictureInput = document.getElementById('profilePictureInput');
        const changePhotoButton = document.getElementById('changePhotoButton');

        // Add Work Today form elements
        const addWorkForm = document.getElementById('addWorkForm');
        const workDateInput = document.getElementById('work-date');
        const workDescriptionInput = document.getElementById('work-description');
        const workHistoryList = document.getElementById('workHistoryList');
        const wordCountSpan = document.getElementById('wordCount');
        const wordLimitSpan = document.getElementById('wordLimit');
        const wordLimitWarning = document.getElementById('wordLimitWarning');
        const submitWorkButton = document.getElementById('submitWorkButton');

        const MAX_WORDS = 60; // Define the word limit

        // Function to hide all content sections and remove active class from menu items
        function hideAllContentSections() {
            contentSections.forEach(section => {
                section.classList.remove('active');
            });
            menuItems.forEach(item => {
                item.classList.remove('active');
            });
        }



        // Add click event listener to menu toggle button
        menuToggleButton.addEventListener('click', function() {
            dashboardContent.classList.toggle('menu-open'); // Toggle class on main-card
            menuSection.classList.toggle('hidden'); // Toggle hidden class on menu section
            hamburgerIcon.classList.toggle('hidden'); // Toggle hamburger icon visibility
            closeIcon.classList.toggle('hidden'); // Toggle close icon visibility
        });

        // Add click event listeners to menu items
        menuItems.forEach(item => {
            item.addEventListener('click', function(event) {
                event.preventDefault();
                const targetContentId = this.dataset.content + '-section'; // Get target content ID from data-content attribute

                hideAllContentSections(); // Hide all sections and remove active class from all menu items
                document.getElementById(targetContentId).classList.add('active'); // Show the clicked section
                this.classList.add('active'); // Add active class to the clicked menu item

                // Special handling for Profile section: ensure it's in view mode when navigated to
                if (this.dataset.content === 'profile') {
                    profileDetails.classList.remove('hidden');
                    profileEditForm.classList.add('hidden');
                    toggleEditProfileButton.textContent = 'Edit Profile';
                    // Reset profile picture preview if it was changed but not saved
                    profilePicturePreview.src = headerProfilePhoto.src;
                }

                // Close menu after selection on smaller screens
                if (window.innerWidth < 1024) { // Assuming lg breakpoint is 1024px
                     dashboardContent.classList.remove('menu-open');
                     menuSection.classList.add('hidden');
                     hamburgerIcon.classList.remove('hidden');
                     closeIcon.classList.add('hidden');
                }

                // Special handling for Logout: reload page
                if (this.dataset.content === 'logout') {
                    // In a real app, this would clear session and redirect to login
                    // For this simulation, we just show the logout message
                }
            });
        });

        // Add click event listener for the "Quick Add Work" button
        quickAddWorkButton.addEventListener('click', function(event) {
            event.preventDefault();
            hideAllContentSections();
            document.getElementById('add-work-section').classList.add('active');
            // Also set the "Add Work Today" menu item as active
            document.querySelector('.menu-item[data-content="add-work"]').classList.add('active');

            // Close menu after selection on smaller screens
            if (window.innerWidth < 1024) { // Assuming lg breakpoint is 1024px
                dashboardContent.classList.remove('menu-open');
                menuSection.classList.add('hidden');
                hamburgerIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }
        });

        // Toggle Edit Profile functionality
        toggleEditProfileButton.addEventListener('click', function() {
            if (profileDetails.classList.contains('hidden')) {
                // Currently in edit mode, switch to view mode (simulate save)
                profileDetails.classList.remove('hidden');
                profileEditForm.classList.add('hidden');
                toggleEditProfileButton.textContent = 'Edit Profile';

                // Update display values with edited values (simulated save)
                profileName.textContent = editName.value;
                profileEmail.textContent = editEmail.value;
                profileContact.textContent = editContact.value;
                profileAddress.textContent = editAddress.value;

                // Update main profile photo with preview photo
                headerProfilePhoto.src = profilePicturePreview.src;

            } else {
                // Currently in view mode, switch to edit mode
                profileDetails.classList.add('hidden');
                profileEditForm.classList.remove('hidden');
                toggleEditProfileButton.textContent = 'Save Changes';

                // Populate edit form with current display values
                editName.value = profileName.textContent;
                editEmail.value = profileEmail.textContent;
                editContact.value = profileContact.textContent;
                editAddress.value = profileAddress.textContent;
                // Set preview to current header photo
                profilePicturePreview.src = headerProfilePhoto.src;
            }
        });

        // Trigger file input when "Change Photo" button is clicked
        changePhotoButton.addEventListener('click', function() {
            profilePictureInput.click();
        });

        // Handle file selection for profile picture
        profilePictureInput.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profilePicturePreview.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });


        // Function to update word count and check limit
        function updateWordCount() {
            const text = workDescriptionInput.value.trim();
            const words = text.split(/\s+/).filter(word => word.length > 0); // Split by whitespace, filter empty strings
            const currentWordCount = words.length;

            wordCountSpan.textContent = currentWordCount;

            if (currentWordCount > MAX_WORDS) {
                wordCountSpan.classList.add('word-count-error');
                wordLimitWarning.classList.remove('hidden');
                submitWorkButton.disabled = true; // Disable submit button
            } else {
                wordCountSpan.classList.remove('word-count-error');
                wordLimitWarning.classList.add('hidden');
                submitWorkButton.disabled = false; // Enable submit button
            }
        }

        // Listen for input changes on the description textarea
        workDescriptionInput.addEventListener('input', updateWordCount);


        // Handle Add Work Today form submission
        addWorkForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission

            const workDate = workDateInput.value;
            const workDescription = workDescriptionInput.value;

            // Re-check word count on submit to be safe
            const text = workDescription.trim();
            const words = text.split(/\s+/).filter(word => word.length > 0);
            if (words.length > MAX_WORDS) {
                console.error("Work description exceeds word limit.");
                wordLimitWarning.classList.remove('hidden'); // Ensure warning is visible
                return; // Prevent submission
            }

            if (workDescription.trim() === '') {
                console.error("Work description cannot be empty.");
                return;
            }

            // Format the date to dd/mm/yyyy
            const dateParts = workDate.split('-'); // Splits YYYY-MM-DD
            const formattedDate = `${dateParts[2]}/${dateParts[1]}/${dateParts[0]}`; // Re-arranges to DD/MM/YYYY

            // Create a new list item for work history
            const newWorkItem = document.createElement('li');
            newWorkItem.className = 'flex items-center p-3 bg-white rounded-lg shadow-sm';
            newWorkItem.innerHTML = `
                <svg class="w-5 h-5 mr-3 text-blue-main" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                <span class="font-medium">${formattedDate}</span> &mdash; ${workDescription}
            `;

            // Add the new item to the beginning of the work history list
            workHistoryList.prepend(newWorkItem);

            // Clear the form fields and reset word count
            workDescriptionInput.value = '';
            workDateInput.valueAsDate = new Date(); // Resets to current date
            updateWordCount(); // Reset word count display

            // Switch to My Work History section
            hideAllContentSections();
            document.getElementById('work-history-section').classList.add('active');
            document.querySelector('.menu-item[data-content="work-history"]').classList.add('active');

            // Close menu after submission on smaller screens
            if (window.innerWidth < 1024) {
                dashboardContent.classList.remove('menu-open');
                menuSection.classList.add('hidden');
                hamburgerIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }
        });

    </script>
</body>
</html>